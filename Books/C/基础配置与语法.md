# C介绍

## C的标准

<table>
    <tr>
        <td width="10%">ANSI C</td>
        <td width="90%"></td>
    </tr>
    <tr>
        <td>C90</td>
        <td></td>
    </tr>
    <tr>
        <td>C99</td>
        <td></td>
    </tr>
    <tr>
        <td>C11</td>
        <td></td>
    </tr>
</table>

## C的编程机制

### 目标代码文件、可执行文件、库

- C编程的基本策略是，将源代码文件转换为可执行文件（包含可直接执行的机器语言代码）。典型的C通过编译和链接来完成这一过程，也就是采取“分而治之”的方法对程序进行模块化，可以独立编译单独的模块，之后再用链接器合并已编译的模块。此外，链接器还会将编写的程序和预编译的库代码合并。

1. <b>编译器</b>把源代码转换成中间代码（<b>目标代码</b>），例如机器语言代码，并把结果放到目标文件中。此时，还缺少启动代码以及库函数。
2. <b>链接器</b>把中间代码和其他代码合并，生成可执行文件。也就是，将<b>目标代码、系统的标准启动代码、库代码</b>这三个部分合并为一个可执行文件。对于库代码，链接器只会把程序中要用到的库函数代码提取出来。

- 大部分C系统要求C语言的<b>源代码文件（source code file）</b>以<code>.c</code>为扩展名。
- <b>启动代码（startup code）</b>充当程序和系统之间的接口，尽管目标代码相同，但不同系统的启动代码不一定相同。

<img src="../../pictures/C-编译器和链接器.drawio.svg" width="400"/> 

### 操作系统与编译器

1. 大部分系统的编译器在编译完成后会自动运行链接器。
2. 通常情况下，C编译器生成的中间目标代码文件的扩展名是<code>.obj</code>。不同的编译器生成的中间目标代码文件的扩展名可能不同。

<table>
    <tr>
        <th>OS</th>
        <th>编译器</th>
        <th>编译语句</th>
        <th>可执行文件</th>
    </tr>
    <tr>
        <td width="15%">UNIX</td>
        <td width="15%">cc</td>
        <td width="20%"><code>cc itarget.c</code></td>
        <td width="50%">a.out</td>
    </tr>
    <tr>
        <td>Linux</td>
        <td>gcc / cc</td>
        <td>gcc itarget.c</td>
        <td>a.out</td>
    </tr>
    <tr>
        <td>Windows</td>
        <td>Cygwin<br/>MinGW</td>
        <td>-</td>
        <td>itarget.exe</td>
    </tr>
</table>

## C程序的结构

<img src="../../pictures/C-C程序的结构.drawio.svg" wifth="600"/> 

```c
#include <stdio.h>

int main(){
        int num;
        num = 1;
        printf("Hello C, %d", num);
        return 0;
}
```

### <code>#include指令和头文件</code>

- <code>#include</code>是C预处理器指令（prepocessor directive），C编译器在编译前通常会对源代码进行预处理（prepocessor）。
- <b>头文件（header）</b>是在C程序顶部的信息集合，例如<code>stdio.h</code>文件是标准输入/输出头文件，所有的C编译器软件包都提供<code>stdio.h</code>文件。

1. 大多数情况下，头文件包含了编译器创建最终可执行程序要用到的信息，而函数的实际代码放在预编译代码的库文件中。
2. ANSI/ISO C 规定了C编译器必须提供哪些头文件，特定C实现的文档中应该包含对C库函数的说明，以此确定了使用哪些函数需要包含哪些头文件。

### <code>main()</code>函数

- C程序一定从<code>main()</code>函数开始执行，函数是C程序的基本模块。

### 注释

<table>
    <tr>
        <td width="20%"><code>/* */</code></td>
        <td width="80%">多行注释</td>
    </tr>
    <tr>
        <td><code>//</code></td>
        <td>单行注释</td>
    </tr>
</table>

### 花括号、函数体、块

- 一般而言，所有的C函数都使用<b>花括号{}</b>标记函数的开始和结束。花括号<code>{}</code>还可以将函数中的多条语句合并为一个单元或块。

### 声明

- <b>声明（declaration）</b>是C语言最重要的特性之一，编译器使用声明的信息来为<b>变量（variable）</b>在内存中分配存储空间。

1. 声明把特定<b>标识符（identifier）</b>（变量、函数或其他实体的名称）与计算机内存中的特定位置联系起来，同时也确定了存储在某位置的信息类型或数据类型。
2. 在C语言中，所有变量都必须先声明才能使用。

- 命名：C99和C11允许使用更长的标识符名，但是编译器只识别前63个字符（如果超过可能不会正确识别）。

1. 标识符可以使用小写字母、大写字母、数字、下划线（<code>_</code>）来命名。
2. 操作系统和C库经常用以一个或两个下划线字符开始的标识符（标准标签），例如 “<code>_kcab</code>”。为避免名称冲突，应该避免使用下划线开头的标识符。
3. C语言的名称区分大小写。
4. C99和C11根据UCN（通用字符名）机制添加了扩展字符集。

### 赋值

- 赋值表达式语句（C语言是通过赋值运算符而不是赋值语句完成赋值操作的）。在变量声明时，编译器在计算机内存中为变量预留了空间，而在执行赋值表示式时，把值存储到之前预留的位置。

### 函数

- C程序由一个或多个函数组成，必须有main()函数。

1. 函数由函数头和函数体组成。函数头包括函数名、传入该函数的信息类型和函数的返回类型。
2. 通过函数名后的圆括号（<code>()</code>）可识别出函数，圆括号里可能为空，可能有参数。
3. 函数体被花括号（<code>{}</code>）括起来，由一系列语句、声明组成。