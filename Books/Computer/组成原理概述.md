# 冯·诺依曼体系

## 存储程序概念

- 存储程序概念：指令驱动\+存储，指令和数据都在存储器中。将事先编制好的程序和原始数据送入主存后才能执行，一旦程序启动，就无须操作人员的干预，计算机自动逐条执行指令直到程序执行结束。
1. 计算机硬件系统由运算器、存储器、控制器、输入设备、输出设备5大部件组成。
2. 指令和数据以同等地位存于存储器，按地址寻访。
3. 指令和数据均用二进制代码表示。指令由操作码（操作的类型）和地址码（操作数的地址）组成，在存储器中按顺序存放。
6. 以运算器为中心，IO设备与存储器之间的数据传送通过运算器完成。

## 硬件组成

<img src="../../pictures/Snipaste_2023-04-30_10-47-27.png" width="800"/> 

<img src="../../pictures/计算机组成原理-计算机组成.drawio.svg" width="800"/> 

- [主存储器](./Memory.md)

1. M（存储体）存放二进制信息，若干存储单元的集合构成存储体，地址码相同的多个存储元件构成一个存储单元，每个存储元件存放一个二进制位。存储字是存储单元可存放的一串二进制代码，存储字长是这串二进制代码的位数，1Byte或字节的偶数倍。
2. MAR（地址寄存器）存放访存地址，用于寻址，经地址译码后找到所选的存储单元。MAR的位数对应存储单元的个数。
3. MDR（数据寄存器）暂存要从存储器中读/写的信息。MDR的位数和存储字长相等，对应于数据总线的宽度。
4. 时序控制逻辑用于产生存储器操作所需的各种时序信号。

> 现代计算机中，MDR、MAR、Cache都存在于CPU。

- 运算器

1. ALU（算术逻辑单元，Arithmetic and Logical Unit）是运算器的核心。
2. 运行器包含若干通用寄存器，用于暂存操作数和中间结果，必须具备ACC（累加器）、MQ（乘商寄存器）、X（操作数寄存器）。

- 控制器

1. PC（程序计数器）存放当前欲执行指令的地址，自动加1，与MAR之间有一条直接通路。
2. IR（指令寄存器）存放当前的指令，内容来自MDR。指令中的操作码OP（IR）送至CU，用于分析指令并发出各种微操作命令序列；而地址码Ad（IR）送至MAR，用于取操作数。
3. CU（控制单元）

## 存储器设计思想

### 冯·诺依曼结构

<img src="../../pictures/Snipaste_2023-04-30_12-46-30.png" width="350"/>     

- 指令和数据混合存储在同一个存储器中：指令地址和数据地址指向同一个存储的不同物理位置，指令和数据的宽度相同。
- CPU和共享存储器间的信息交换：不能同时取指令和取操作数，且存储器的存取速度远低于CPU运算速度。

### 哈弗结构

<img src="../../pictures/Snipaste_2023-04-30_12-48-58.png" width="600"/> 

- 指令存储在程序存储器（PM)，数据存储在数据存储器（DM）：指令和数据可以有不同的数据宽度。
- 分离的程序总线和数据总线允许同时获取指令字和操作数而互不干扰：在一个机器周期内可以同时准备好指令和操作数，本条指令执行时可以预先读取下一条指令。

# 层次结构

<img src="../../pictures/Snipaste_2023-04-30_13-08-26.png" width="500"/> 

# 性能指标

## 机器字长

- 字长：参与运算的数的基本位数：由加法器、寄存器的位数决定。
- 字长越长，精度越高。
- 字节（Byte）：
  - 1 PB = 1024 TB 
  - 1 TB = 1024 GB 
  - 1 GB = 1024 MB 
  - 1 MB = 1024 KB 
  - 1 KB = 1024 B 
  - 1 B = 8 bit

## 数据通路宽度

- 数据通路宽度：数据总线一次所能并行传送信息的位数。

## 存储容量

- 存储器容量：主存容量、辅存容量。
  - 主存容量：主存中存放二进制代码的总位数。

> 字节编址：以字节数表示存储容量。

- MAR（存储器地址寄存器）：存储单元个数。
- MDR（存储器数据寄存器）：存储字长。

<img src="../../pictures/20231030222326.png" width="500"/> 

## 运算速度

### 吞吐量和响应时间

- 吞吐量：系统单位时间内处理请求的数量。
- 响应时间：系统对请求做出响应的时间 = CPU时间 + 等待时间。

### 主频和CPU时钟周期

- CPU主频（时钟频率）：在CPU内数字脉冲信号振荡的速度。
- CPU时钟周期：CPU主频的倒数，CPU中最小的时间元素，每个动作至少需要一个时钟周期。

### CPI

- CPI：每条指令执行所用的时钟周期数。
- IPC：每个时钟周期执行的指令数。 

<img src="../../pictures/20231030222446.png" width="150"/> 

### CPU执行时间

<img src="../../pictures/20231030222528.png" width="400"/> 

### MIPS和MFLOPS

- MIPS：每秒执行多少百万条指令。

<img src="../../pictures/20231030222722.png" width="320"/> 

- MFLOPS：每秒执行多少百万次浮点运算。

<img src="../../pictures/20231030222800.png" width="260"/> 
