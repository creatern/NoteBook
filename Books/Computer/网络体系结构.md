# 计算机网络概述

## 计算机网络的概念

- 计算机网络是一个将分散的、具有独立功能的计算机系统，通过通信设备与线路连接起来，由功能完善的软件实现资源共享和信息传递的系统。即一些互连的、自治的计算机系统的集合。

1. 目的，资源共享。
2. 组成单元，分布在不同地理位置的多台独立的自治计算机。
3. 网络中的计算机必须遵循的统一规则，网络协议。

## 计算机网络的组成

- 组成部分，一个完整的计算机网络主要由硬件、软件、协议三大部分组成。

1. 硬件主要由主机（端系统）、网络通信链路（双绞线、光纤）、交换设备（路由器、交换机）、通信处理机（网卡）等组成。
2. 软件主要包括各种实现资源共享的软件和方便用户使用的各种工具软件（网络操作系统、邮件收发程序、FTP程序、聊天程序等）。
3. 协议是计算机网络的核心，规定了网络传输数据时所遵循的规范。

- 工作方式，Internet（因特网）分为边缘部分和核心部分。

1. 边缘部分由所有连接到因特网上、供用户使用的主机组成，用来进行通信和资源共享。
2. 核心部分由大量的网络和连接到这些网络的路由器组成，为边缘部分提供连通性和交换服务。

<img src="../../pictures/计算机网络-核心部分和边缘部分.drawio.svg" width="400"/> 

- 功能组成，计算机网络由通信子网和资源子网组成。

1. 通信子网由各种传输介质、通信设备和相应的网络协议组成，包括物理层（集线器）、数据链路层（交换机）、网络层（路由器），使网络具有数据传输、交换、控制和存储的能力，实现联网计算机之间的数据通信。
2. 资源子网是实现资源共享功能的设备及其软件的集合，向网络用户提供分享其他计算机上硬件资源、软件资源和数据资源的服务。

## 计算机网络的功能

1. 数据通信。计算机网络最基本和最重要的功能。
2. 资源共享。
3. 分布式处理。
4. 提高可靠性。
5. 负载均衡。

## 计算机网络的分类

### 覆盖范围

| 类型              | 覆盖范围           | 说明                                   |
| ----------------- | ------------------ | -------------------------------------- |
| WAN（广域网）     | 几十千米至几千千米 | 基于广播技术发展，通常采用网状拓扑结构 |
| MAN（城域网）     | 5\~50km            |                                        |
| LAN（局域网）     | 几十米至几千米     | 基于交换技术发展                       |
| PAN（个人局域网） | 10m                |                                        |

> 若中央处理器之间的距离非常近，仅1m或更小的数量级，一般称为多处理器系统，而不是计算机网络。

### 传输技术

1. 广播式网络。该网络中的所有联网计算机共享一个公共通信信道，一台计算机通过共享通信信道发送报文时，所有其他计算机都会收到该分组。
2. 点对点网络（P2P）。每条物理线路连接一对计算机。

### 拓扑结构

- 网络拓扑结构是由网中结点（路由器、主机等）与通信线路（网线）之间的几何关系表示的网络结构，计算机网络拓扑结构主要取决于通信子网。

<img src="../../pictures/计算机网络-网络拓扑结构.drawio.svg" width="1000"/>

| 网络拓扑 | 说明                                         | 特点                                                         |
| -------- | -------------------------------------------- | ------------------------------------------------------------ |
| 总线形   | 单根传输线将计算机连接                       | 建网容易，增/减结点方便，节省线路<br />重负载时通信效率低，总线任意一处对故障敏感 |
| 星形     | 每个终端以独立的线路与中央设备（主机或）相连 | 便于集中控制和管理，端用户之间的通信必须经过中央设备<br />成本高、中央设备对故障敏感 |
| 环形     | 所有计算机接口设备连接成一个环               | 令牌环网，环中信号是单向传输的                               |
| 网状     | 一般，每个结点至少有两条路径和其他接口相连   | 可靠性高，控制复杂，线路成本高                               |

- 以上各种网络拓扑结构可以互连。

### 交换技术

<details>
    <summary>比较电路交换网络和分组交换网络，要传送的报文共x比特。从源点到终点一定经过k段链路，每段链路的传播时延为d秒，数据传输速率为b比特每秒。在电路交换时电路的建立时间为s秒。在分组交换时分组长度为p比特，且各结点的排队等待时间可忽略不计。问在何种条件下，分组交换的时延比电路交换的时延小？</summary>
    对于k段链路共经过k-1个结点，设有n个分组（不等于x/p，np&asymp;x）<br/>
    1. 电路交换时延 = s + kd + x/b<br/>
    2. 分组交换时延 = kd + np/b + (k-1)p/b<br/>
    要求 kd + np/b + (k-1)p/b &lt; s + kd + x/b，则 (k-1)p/b &lt; s<br/>
    <img src="../../pictures/计算机网络-交换技术-电路交换-分组交换.drawio.svg" width="600"/>
</details>

#### 电路交换网络

- 电路交换网络在源结点和目的结点之间建立一条专用的通路用于传送数据，包括建立连接、传输数据、断开连接三个阶段。最典型的是传统电话网络。

1. 数据直接传送、时延小
2. 线路利用率低、不能充分利用线路容量、不便差错控制。

#### 报文交换网络

- 报文交换网络（存储-转发网络），用户数据加上源地址、目的地址、校验码等辅助信息，之后封装为报文。整个报文传送到相邻结点，全部存储后，再转发到下一个结点，直到到达目的结点。每个报文可以单独选择到达目的结点的路径。整个报文先传输到相邻结点，全部存储后，查找转发表，转发到下一个结点。

1. 可以较充分地利用线路容量，实现不同链路之间不同数据传输速率的转换、格式转换。
2. 可以实现一对多、多对一的访问，实现差错控制。
3. 增大了资源开销，封装了额外的辅助信息。
4. 增加了缓冲机制，需要额外的控制机制来保证多个报文的顺序。
5. 缓冲区难以管理，接收方在接收到报文之前不能预知报文的大小。

#### 分组交换网络

- 分组交换网络（包交换网络）将数据分成较短的固定长度的数据块，在每个数据块中加上目的地址、源地址等辅助信息封装为分组（包），以存储-转发方式传输。单个分组（报文的一部分）传送到相邻结点，存储后查找转发表，转发到下一个结点。

1. 具有报文交换网络的优点。
2. 缓冲易于管理。
3. 包的平均时延更小，网络占用的平均缓冲区更少。
4. 更易于标准化，更适合应用。
5. 资源开销大于报文交换网络。

## 计算机网络的性能指标

- 带宽（Bandwidth，最高数据传输速率）在计算机网络中，表示网络的通信线路所能传送数据的能力（bit/s）。
- 速率（Speed，数据传输速率、数据率、比特率），连接计算机网络上的主机在数字通道上传送数据的速率（bit/s），最高数据传输速率也就是带宽。

- 时延（Delay）= 发送时延 + 传播时延 + 处理时延 + 排队时延，指数据从网络的一端传送到另一端所需的总时间。

<img src="../../pictures/计算机网络-时延delay.drawio.svg" width="500"/> 

1. 发送时延（传输时延） = 分组长度 / 信道宽度，结点将分组的所有比特推向传输链路所需的时间，即从发送分组的第一个比特计算，到该分组的最后一个比特发送完毕所需的时间。

>对于高速链路，仅只是提高数据发生速率，减少发送时延，而不是提高数据在信道上的传播速率，更没有减少传播时延。

2. 传播时延 = 信道长度 / 电磁波在该信道上的传播速率，电磁波在信道中传播一定的距离所需的时间，即一个比特从链路的一端传播到另一端所需的时间。
3. 处理时延，数据在交换结点中为存储转发而进行的一些必要的处理所需要的时间。
4. 排队时延，分组在进入路由器之后，要先在输入队列中排队等待处理；路由器确定转发端口后，要在输出队列中排队等待转发。

> 处理时延和排队时延一般忽略不计。

- 时延带宽积（以比特为单位的链路长度）= 传播时延 x 信道带宽，指发送端发送的第一个比特即将到达站点时，发送端已经发出了多少个比特。
- RTT（往返时延，Round-Trip Time），指从发送端发出一个短分组，到发送端收到来自接收端的确认，总共经历的时延。 

- 吞吐量（Throughput）指单位时间内通过某个网络（信道、接口）的数据量，吞吐量受网络带宽和网络额定速率的限制。

- 信道利用率 = 有效数据通过时间 / (有效数据通过时间 + 空闲时间)，指出某一信道有百分之几的时间是有数据通过的。

<details>
    <summary>
        在下列情况，计算传送1000KB文件所需要的总时间t（从开始传送时起直到文件的最后一位到达目的地为止）。假定RTT为100ms，一个分组是1KB的数据，在开始传送整个文件之前进行的起始握手过程需要2RTT的时间，只有一段链路。<br/>
        （1）带宽为1.5Mb/s，数据可连续发送。<br>
        （2）带宽为1.5Mb/s，但每发送完一个数据分组后，必须等待一个RTT（等待接收方的确认）才能发送下一数据分组。<br/>
        （3）假定带宽无限大（发送时延为0），并在等待每条RTT之后可以发送最多20个分组。
    </summary>
    此题，传播时延 = RTT / 2，最后一组数据分组不需要等待确认，只需要RTT/2<br/>
    （1）t = 起始握手时间 + 传播时延 + 发送时延 = 2RTT + RTT/2 + 1000KB / 1.5Mb/s<br/>
    （2）t = 起始握手时间 + 传播时延 + 发送时延 + 等待确认时间 = 2RTT + RTT/2 + 1000KB / 1.5Mb/s + (⌈1000KB / 1KB⌉ - 1)RTT<br/>
    （3）t = 起始握手时间 + 传播时延 + 等待确认时间 = 2RTT + RTT/2 + (⌈(1000KB / 1KB / 20)⌉ - 1)RTT<br/>
    <img src="../../pictures/计算机网络-RTT.drawio.svg" width="400"/>
</details>

# 计算机网络分层结构