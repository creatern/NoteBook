# 服务单元控制

| 文件扩展名               | 类型                          |
| ------------------------ | ----------------------------- |
| \.device                 | 能被内核识别的设备            |
| \.service                | 系统服务                      |
| \.target                 | 一组系统服务（Linux启动相关） |
| \.mount<br />\.automount | 挂载点<br />自动挂载点        |
| \.path                   | 文件系统的文件/目录           |
| \.scope                  | 外部创建的进程                |
| \.slice                  | 一组分层次管理的系统进程      |
| \.snapshot               | 系统服务状态管理              |
| \.socket                 | 进程间通讯套接字              |
| \.swap                   | 定义swap文件、swap设备        |
| \.timer                  | 定时器                        |

# 服务单元控制命令 systemctl、systemd

| **运行级别**                                               | **说明**                                                     |
| ---------------------------------------------------------- | ------------------------------------------------------------ |
| systemctl set-default                                      | 更改默认运行级别，重启后生效<br />（/etc/systemd/ssytem/default.target 的指向） |
| systemctl rescue                                           | 紧急模式                                                     |
| **服务单元**                                               | **说明**                                                     |
| systemctl start<br />systemctl restart<br />systemctl stop | 启动服务<br />重新启动服务<br />停止服务                     |
| systemctl enable<br />systemctl disable                    | 设置开机自启动<br />禁止开机自启动                           |
| systemctl status                                           | 查看服务当前状态                                             |
| **电源控制**                                               | **说明**                                                     |
| systemctl poweroff                                         | 关机                                                         |
| systemctl reboot                                           | 重启                                                         |
| systemctl suspend                                          | 待机                                                         |

| systemctl set-default参数 | 指向                                      | 运行级别 |
| :------------------------ | :---------------------------------------- | :------- |
| default.target            | /etc/systemd/system/default.target        | -        |
| multi-user.target         | /usr/lib/systemd/system/multi-user.target | 3        |
| graphical.target          | /usr/lib/systemd/system/graphical.target  | 5        |

# /etc/systemd/system 单元配置文件

| 存放位置                | 说明                             |
| ----------------------- | -------------------------------- |
| /usr/lib/systemd/system | 软件包安装的单元                 |
| /etc/systemd/system     | 系统管理员安装的与系统密切的单元 |

# 运行级别

| 参数 | target（System目标）                | 说明                           |
| ---- | ----------------------------------- | ------------------------------ |
| 0    | runlevel0.target，poweroff.target   | 停机，一般不推荐设置此级别     |
| 1    | runlevel1.target，rescue.target     | 单用户模式                     |
| 2    | runlevel2.target，multi-user.target | 多用户，但是没有网络文件系统   |
| 3    | runlevel3.target，multi-user.target | 完全多用户模式                 |
| 4    | runlevel4.target，multi-user.target | 没有用到                       |
| 5    | runlevel5.target，graphical.target  | X11，一般对应图形界面接口      |
| 6    | runlevel6.target，reboot.target     | 重新启动，一般不推荐设置此级别 |

1. 当系统首次引导时，处理器会执行一个位于已知位置处的代码（一般保存在基本输入/输出系统BIOS）。
2. 找到一个引导设备之后，第一阶段的引导加载程序就被装入RAM并执行。这个引导加载程序在大小上小于512字节（一个扇区），它是加载第二阶段的引导加载程序。
3. 第二阶段的引导加载程序被装入RAM并执行时，通常会显示一个引导屏幕，并将Linux和一个可选的初始RAM磁盘（临时根文件系统）加载到内存中。
4. 加载映像时，第二阶段的引导加载程序就会将控制权交给内核映像，然后内核就可以进行解压和初始化。在这个阶段中，第二个阶段的引导加载程序会检测系统硬件、枚举系统链接的硬件设备、挂载根设备，然后加载必要的内核模块。
5. 完成这些操作之后启动第一个程序systemd，并执行高级系统初始化工作。
6. 通过以上过程系统完成引导，等待用户登录。

<img src="../../pictures/Linux-Linux启动运行级别202310121316.drawio.svg" width="600"/>  

## runlevel 当前用户运行级别

## init 系统运行级别

- init：改变系统运行级别。init进程是所有Linux进程的父进程，它的进程号为1。

## /etc/inittab init配置文件

# 
