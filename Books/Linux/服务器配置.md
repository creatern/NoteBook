# 网络服务

## NAT

- NAT网络地址转换，将IP数据包头中的IP地址转换为另外一个IP地址，以实现私有IP地址访问公有网络。
- NAT会自动修改IP报文的源IP地址和目的IP地址，IP地址校验在NAT处理过程中自动完成。

<img src="../../pictures/Snipaste_2022-12-12_14-33-36.png" width="400"/> 

| NAT的实现    | 说明                                                         |
| ------------ | ------------------------------------------------------------ |
| 静态转换     | 某个私有IP地址只能转换为某个指定的公有IP地址。               |
| 动态转换     | IP地址是随机的，系统会自动随机选择一个没有被使用的公有IP地址进行转换。 |
| 端口多路复用 | 修改数据包的源端口并进行端口转换，使内部网络的多台主机可以共享一个公有IP地址。 |

- 配置NAT服务。

```shell
# 开启转发功能
echo 1 > /proc/sys/net/ipv4/ip_forward

# 将网络接口加入到外部区域
# 查看网络接口ens33所属区域
firewall-cmd --get-zone-of-interface=ens33
# 改变区域为external
firewall-cmd --permanent --zone=external --change-interface=ens33
# 查看外部区域配置
firwall-cmd --zone=external --list-all
# 打开外部区域的伪装
firewall-cmd --permanent --zone=external --add-masquerade

# 配置内部接口
firewall-cmd --get-zone-of-interface=ens101
firewall-cmd --permanent --zone=internal --change-interface=ens101
```

> **配置上网**
>
> 将所有主机的网关设置为RHEL主机的网络接口ens101（内部接口）的IP地址，内部网络的主机的DNS服务器设置为运营商提供的DNS服务器的地址。

## 远程传输

| 命令   | 说明                                                         |
| ------ | ------------------------------------------------------------ |
| scp    | 加密的方式在本地主机和远程主机之间复制文件                   |
| rsync  | 远程数据同步工具、只传送两个文件的不同部分                   |
| telnet | 登录远程主机和管理（测试ip端口是否连通）<br />明文传送报文，安全性不好 |
| wget   | 支持FTP和HTTP下载                                            |

