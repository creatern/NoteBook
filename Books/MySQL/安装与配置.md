# MySQL安装

## Ubuntu20.4

```shell
sudo apt update
sudo apt install mysql-server -y
```

```shell
# 测试mysql
sudo systemctl status mysql
sudo systemctl is-active mysql

# 设置自动启动
sudo systemctl enable mysql
```

- 该方式安装的Mysql默认使用无密码登录，可通过以下修改为密码登录

```sql
alter user 'root'@'localhost' 
identified with mysql_native_password
by 'root';

flush privileges;
```

## Fedora39

```shell
# 安装 MySQL 存储库，也就是写入存储库文件 /etc/yum.repos.d/mysql-community.repo
sudo dnf -y install https://dev.mysql.com/get/mysql80-community-release-fc39-1.noarch.rpm
# 添加存储库并确认启用后，继续运行以下命令将 MySQL 8.0 安装到 Fedora 上
sudo dnf install mysql-community-server

# 启动和启用 mysqld 服务
sudo systemctl start mysqld.service
sudo systemctl enable mysqld.service

# 复制 root 用户生成的随机密码，需要记下打印的密码
sudo grep 'A temporary password' /var/log/mysqld.log | tail -1
# 启动 MySQL 安全安装以更改 root 密码、禁止远程 root 登录、删除匿名用户和删除测试数据库。
sudo mysql_secure_installation
# 通过之前的随机密码，以 root 用户身份连接到 MySQL 数据库并创建测试数据库
sudo mysql -u root -p
```

## Docker

```shell
# mysql5.7启动
docker run -it --name mysql5.7 \
-p 3306:3306 \
-e MYSQL_ROOT_PASSWORD=root \
-e MYSQL_UNIX_SOCKET=/tmp/mysql.sock \
-d mysql:5.7
```

# 远程访问

## MySQL

```shell
# 使用root用户访问远程主机（192.168.124.159:3306）上的MySQL服务器
mysql -u root -h 192.168.124.159 --port 3306 -p
```

- 给予root用户被远程登陆的权限：允许所有IP地址的主机以root用户远程访问MySQL服务器

```mysql
# 查看允许远程登陆的主机IP地址
use mysql
select user, authentication_string, Host from user;

# 方式1. 直接修改表
update user set host='%' where user='root';

# 方式2. grant授权
GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' WITH GRANT OPTION;
FLUSH PRIVILEGES;
```

- 修改MySQL的配置文件（/etc/mysql/my.cnf）：

```shell
# vim /etc/mysql/my.cnf

!includedir /etc/mysql/conf.d/
!includedir /etc/mysql/mysql.conf.d/

# 置于前两句之后，避免被覆盖
[mysqld]
bind-address = 0.0.0.0
```

## 防火墙

```shell
# 防火墙上允许端口 3306
sudo firewall-cmd --add-service=mysql --permanent
sudo firewall-cmd --reload
```

```shell
# Ubuntu 可以使用 ufw 来配置
sudo ufw allow mysql
```

